! Spine/RR Configuration for EVPN VXLAN
! This router acts as Route Reflector for EVPN and provides underlay connectivity

! Zebra configuration
interface eth0
 ip address 10.1.1.1/30
!
interface eth1
 ip address 10.1.2.1/30
!
interface eth2
 ip address 10.1.3.1/30
!
interface lo
 ip address 1.1.1.1/32
!

! OSPF configuration for underlay
router ospf
 router-id 1.1.1.1
 network 10.1.1.0/30 area 0
 network 10.1.2.0/30 area 0
 network 10.1.3.0/30 area 0
 network 1.1.1.1/32 area 0
!

! BGP configuration for EVPN Route Reflector
router bgp 1
 bgp router-id 1.1.1.1
 no bgp ebgp-requires-policy
 neighbor ibgp peer-group
 neighbor ibgp remote-as 1
 neighbor ibgp update-source lo
 bgp listen range 1.1.1.0/29 peer-group ibgp
  !  can list 1.1.1.1 - 1.1.1.6 as peer-group ibgp
 address-family l2vpn evpn
  neighbor ibgp activate
  neighbor ibgp route-reflector-client
 exit-address-family
!

# Verification commands for Spine (Route Reflector)
# Check BGP neighbor status
vtysh -c "show bgp summary"
vtysh -c "show bgp l2vpn evpn summary"

# Check EVPN routes received from all leafs
vtysh -c "show bgp l2vpn evpn route"

# Check BGP peer group status
vtysh -c "show bgp peer-group"

# Check OSPF neighbor status
vtysh -c "show ip ospf neighbor"

# Check routing table
vtysh -c "show ip route"